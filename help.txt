List list =  d.bank_statements(conn, 1L);
   ListIterator<Passbook> ltr = list.listIterator();
  // while(ltr.hasNext()) {
	//   System.out.println(ltr.next().getParticulars());
 //  }
   /////////////////////////////
   Workbook wb = new XSSFWorkbook();
   Sheet sheet = wb.createSheet("Transactions");
// Row 0 – Account Holder Name
Row row0 = sheet.createRow(0);
Cell cell0 = row0.createCell(0);
cell0.setCellValue("Name: Sagar Pansare");
sheet.addMergedRegion(new CellRangeAddress(0, 0, 0, 4));

// Row 1 – Account Number
Row row1 = sheet.createRow(1);
Cell cell1 = row1.createCell(0);
cell1.setCellValue("Account No: 1234567890");
sheet.addMergedRegion(new CellRangeAddress(1, 1, 0, 4));

// Row 2 – Status
Row row2 = sheet.createRow(2);
Cell cell2 = row2.createCell(0);
cell2.setCellValue("Status: ACTIVE");
sheet.addMergedRegion(new CellRangeAddress(2, 2, 0, 4));
//////Style design
CellStyle titleStyle = wb.createCellStyle();
Font titleFont = wb.createFont();
titleFont.setBold(true);
titleFont.setFontHeightInPoints((short) 12);
titleStyle.setFont(titleFont);

cell0.setCellStyle(titleStyle);
cell1.setCellStyle(titleStyle);
cell2.setCellStyle(titleStyle);

//////////////////////////////////////////Table start
//header rows
Row header = sheet.createRow(4);

String[] headers = {"Date", "Time", "Particulars", "Debit", "Credit", "Balance"};

CellStyle headerStyle = wb.createCellStyle();
Font headerFont = wb.createFont();
headerFont.setBold(true);
headerStyle.setFont(headerFont);
headerStyle.setBorderBottom(BorderStyle.THIN);
headerStyle.setBorderTop(BorderStyle.THIN);
headerStyle.setBorderLeft(BorderStyle.THIN);
headerStyle.setBorderRight(BorderStyle.THIN);
headerStyle.setAlignment(HorizontalAlignment.CENTER);

for (int i = 0; i < headers.length; i++) {
    Cell cell = header.createCell(i);
    cell.setCellValue(headers[i]);
    sheet.autoSizeColumn(i);
    cell.setCellStyle(headerStyle);
    

}
sheet.createFreezePane(0, 5); // freeze  the rows above the table
//data rows Row header = sheet.createRow(4);
int rowIndex = 5; // header is at row 4, data starts below

while (ltr.hasNext()) {

    Passbook pssb = ltr.next();   // ✅ ONE next() per row

    Row data = sheet.createRow(rowIndex++);

    Timestamp date = pssb.getDate();
    LocalDate fdate = date.toLocalDateTime().toLocalDate();
    LocalTime time = date.toLocalDateTime().toLocalTime();

    data.createCell(0).setCellValue(fdate.toString());
    data.createCell(1).setCellValue(time.toString());
    data.createCell(2).setCellValue(pssb.getParticulars());

    if (pssb.getDebit() != null)
        data.createCell(3).setCellValue(pssb.getDebit().doubleValue());
         
    if (pssb.getCredit() != null)
        data.createCell(4).setCellValue(pssb.getCredit().doubleValue());

    data.createCell(5).setCellValue(pssb.getBalance_after().doubleValue());
}


/////////////////////////////////////////////////////////////////////////////

   FileOutputStream fos = new FileOutputStream("transactions.xlsx");
   wb.write(fos);
   wb.close();
   fos.close();
   
   System.out.println("Excel file created");
